<mat-sidenav-container class="sidenav-container" fullscreen>
  
  <!-- Navbar sidenav -->
  <mat-sidenav #sidenav mode="over" [fixedInViewport]="true">
    <mat-toolbar>
      <span>Menú</span>

      <span class="spacer"></span>

      <button mat-icon-button (click)="sidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>
    </mat-toolbar>

    <mat-nav-list>
      <mat-list-item>
        <a routerLink="./featured-products" mat-list-item class="my-list-item" (click)="sidenav.toggle()">
          <mat-icon mat-list-icon>home</mat-icon>
          <span>Inicio</span>
        </a>
      </mat-list-item>
      <mat-list-item>
        <a routerLink="./search-filter" mat-list-item class="my-list-item" (click)="sidenav.toggle()">
          <mat-icon mat-list-icon>search</mat-icon>
          <span>Búsqueda con filtros</span>
        </a>
      </mat-list-item>
      <mat-list-item>
        <a routerLink="./price-comparison" mat-list-item class="my-list-item" (click)="sidenav.toggle()">
          <mat-icon mat-list-icon>attach_money</mat-icon>
          <span>Comparar precios</span>
        </a>
      </mat-list-item>
    </mat-nav-list>

  </mat-sidenav>


  <!-- Cart sidenav -->
  <mat-sidenav #cartSidenav mode="over" position="end" [fixedInViewport]="true">
    <mat-toolbar>
      <button mat-icon-button (click)="cartSidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>

      <span>Tus productos</span>

      <span class="spacer"></span>
    </mat-toolbar>

    <mat-nav-list *ngFor="let product of cart">
      <mat-card class="card-cart-products">
        <mat-card-header class="text-oneline">
          <mat-card-title-group>
            <img mat-card-sm-image
                 class="cart-image"
                 [src]="product.imagen"
                 (error)="product.imagen = 'assets/error_image_cart.jpg'"
                 [routerLink]="['/comparador', product.id_producto]"
                 (click)="cartSidenav.toggle()">
            <mat-card-title class="card-name" 
                            matListItemTitle
                            [routerLink]="['/comparador', product.id_producto]"
                            (click)="cartSidenav.toggle()">
              {{ product.nombre | titlecase }}
            </mat-card-title>
            <mat-card-subtitle matListItemLine>{{ product.marca | uppercase }}</mat-card-subtitle>
          </mat-card-title-group>
        </mat-card-header>
        <mat-card-actions>
          <!-- Remove item button -->
          <button mat-icon-button color="warn" (click)="removeProductFromCart(product.id_producto)">
            <mat-icon>clear</mat-icon>
          </button>

          <!-- Quantity -->
          <nav>
            <ul class="pagination pagination-sm my-1">
              <li class="page-item button-quantity" [ngClass]="{'disabled': product.cantidad === 1}">
                <a class="page-link" (click)="decreaseProductQuantity(product.id_producto)">-</a>
              </li>

              <li class="page-item"><a class="page-link">{{ product.cantidad }}</a></li>

              <li class="page-item button-quantity">
                <a class="page-link" (click)="increaseProductQuantity(product.id_producto)">+</a>
              </li>
            </ul>
          </nav>

          <span class="spacer"></span>

          <span class="price-product">$ {{ product.precio_total?.toString() | thousandsSeparator }}</span>

        </mat-card-actions>
      </mat-card>
    </mat-nav-list>
    
    <!-- Button price comparision -->
    <div class="d-flex justify-content-center py-2">
      <button mat-raised-button 
              color="primary"
              class="py-4"
              routerLink="./price-comparison"
              (click)="cartSidenav.toggle()">
        COMPARAR
      </button>
    </div>
  </mat-sidenav>

  <!-- Contenido principal -->
  <mat-sidenav-content>
    <!-- Navbar toolbar -->
    <mat-toolbar color="primary" class="align-items-center">

      <button mat-icon-button (click)="sidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>

      <!-- Barra de búsqueda -->
      <div class="wrapper">
        <div class="searchBar">
          <input id="searchQueryInput" type="text" name="searchQueryInput" placeholder="Search" value="" />
          <button id="searchQuerySubmit" type="submit" name="searchQuerySubmit">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="#666666"
                d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
            </svg>
          </button>
        </div>
      </div>

      <!-- Botón de login/register -->
      <div>
        <button mat-icon-button>
          <mat-icon>person</mat-icon>
        </button>
      </div>
    </mat-toolbar>

    <div class="container-fluid">
      <router-outlet></router-outlet>

      <button mat-fab class="floating-element" aria-label="cart" color="warn"
        (click)="cartSidenav.toggle(); getCartProducts()">
        <mat-icon>shopping_cart</mat-icon>
        <div *ngIf="totalProducts > 0" id="badge_cart" [matBadge]="totalProducts"></div>
      </button>
    </div>
    
  </mat-sidenav-content>
</mat-sidenav-container>